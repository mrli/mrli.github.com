<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Ruby,Gems | Lioooo]]></title>
  <link href="http://mrli.github.io/blog/categories/ruby-gems/atom.xml" rel="self"/>
  <link href="http://mrli.github.io/"/>
  <updated>2014-03-22T16:49:32+08:00</updated>
  <id>http://mrli.github.io/</id>
  <author>
    <name><![CDATA[lioooo]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Delayed_job 学习]]></title>
    <link href="http://mrli.github.io/blog/2014/01/10/delayed-job-in-ruby/"/>
    <updated>2014-01-10T16:37:13+08:00</updated>
    <id>http://mrli.github.io/blog/2014/01/10/delayed-job-in-ruby</id>
    <content type="html"><![CDATA[<h5>初始化环境</h5>

<p>```</p>

<pre><code>echo "'delayed_job_active_record','4.0.0'" &gt;&gt; Rails.root/Gemfile

cd Rails.root; bundle install

bundle exec rake generate delayed_job:active_record

rake db:migrate
</code></pre>

<p>```</p>

<p>以上执行完毕后基本的环境已经准备ok!</p>

<h5>启动delayed_job</h5>

<p><code>
cd Rails.root; script/delayed_job start
</code></p>

<h5>添加一个delayed_job 到代码中</h5>

<p>对于ruby 中的任何一个对象,都可以添加到delayed_job中去
例如:</p>

<p>```
class Myjob
  def do_something</p>

<pre><code> #your code
</code></pre>

<p>  end
end
Myjob.new.delay.do_something
```</p>

<h5>配置默认设置 <a href="https://github.com/collectiveidea/delayed_job#gory-details">参考配置</a></h5>

<p>在rails中可以自定义修改<strong><em>delayed_job</em></strong>的默认配置</p>

<p><code>
cd Rails.root; vi config/initializers/delayed_job_config.rb
</code></p>

<p><code>
Delayed::Worker.destroy_failed_jobs = false
Delayed::Worker.sleep_delay = 60
Delayed::Worker.max_attempts = 3
Delayed::Worker.max_run_time = 5.minutes
Delayed::Worker.read_ahead = 10
Delayed::Worker.default_queue_name = 'default'
Delayed::Worker.delay_jobs = !Rails.env.test?
</code></p>

<h5>其它相关</h5>

<p><strong><strong><a href="https://github.com/ejschmitt/delayed_job_web">delayed_job</a></strong></strong></p>
]]></content>
  </entry>
  
</feed>
